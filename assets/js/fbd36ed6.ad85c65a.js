"use strict";(self.webpackChunkkro_docs=self.webpackChunkkro_docs||[]).push([[4729],{55674:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>i,contentTitle:()=>o,default:()=>p,frontMatter:()=>r,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"examples/aws/ack-valkey-cachecluster","title":"Valkey cluster","description":"","source":"@site/versioned_docs/version-0.2.1/examples/aws/ack-valkey-cachecluster.md","sourceDirName":"examples/aws","slug":"/examples/aws/ack-valkey-cachecluster","permalink":"/0.2.1/examples/aws/ack-valkey-cachecluster","draft":false,"unlisted":false,"editUrl":"https://github.com/kubernetes-sigs/kro/tree/main/website/versioned_docs/version-0.2.1/examples/aws/ack-valkey-cachecluster.md","tags":[],"version":"0.2.1","sidebarPosition":304,"frontMatter":{"sidebar_position":304},"sidebar":"examplesSidebar","previous":{"title":"Networking Stack","permalink":"/0.2.1/examples/aws/ack-networking-stack"},"next":{"title":"Controller Deployment","permalink":"/0.2.1/examples/aws/deploying-controller"}}');var t=a(74848),c=a(28453);const r={sidebar_position:304},o="Valkey cluster",i={},l=[];function u(e){const n={code:"code",h1:"h1",header:"header",pre:"pre",...(0,c.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"valkey-cluster",children:"Valkey cluster"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",metastring:'title="valkey-cachecluster.yaml"',children:'apiVersion: kro.run/v1alpha1\nkind: ResourceGraphDefinition\nmetadata:\n  name: valkey.kro.run\nspec:\n  schema:\n    apiVersion: v1alpha1\n    kind: Valkey\n    spec:\n      name: string\n    status:\n      csgARN: ${cacheSubnetGroup.status.ackResourceMetadata.arn}\n      subnets: ${cacheSubnetGroup.status.subnets}\n      clusterARN: ${valkey.status.ackResourceMetadata.arn}\n  resources:\n    - id: networkingStack\n      template:\n        apiVersion: kro.run/v1alpha1\n        kind: NetworkingStack\n        metadata:\n          name: ${schema.spec.name}-networking-stack\n        spec:\n          name: ${schema.spec.name}-networking-stack\n    - id: cacheSubnetGroup\n      template:\n        apiVersion: elasticache.services.k8s.aws/v1alpha1\n        kind: CacheSubnetGroup\n        metadata:\n          name: ${schema.spec.name}-valkey-subnet-group\n        spec:\n          cacheSubnetGroupDescription: "Valkey ElastiCache subnet group"\n          cacheSubnetGroupName: ${schema.spec.name}-valkey-subnet-group\n          subnetIDs:\n            - ${networkingStack.status.networkingInfo.subnetAZA}\n            - ${networkingStack.status.networkingInfo.subnetAZB}\n            - ${networkingStack.status.networkingInfo.subnetAZC}\n    - id: sg\n      template:\n        apiVersion: ec2.services.k8s.aws/v1alpha1\n        kind: SecurityGroup\n        metadata:\n          name: ${schema.spec.name}-valkey-sg\n        spec:\n          name: ${schema.spec.name}-valkey-sg\n          description: "Valkey ElastiCache security group"\n          vpcID: ${networkingStack.status.networkingInfo.vpcID}\n          ingressRules:\n            - fromPort: 6379\n              toPort: 6379\n              ipProtocol: tcp\n              ipRanges:\n                - cidrIP: 0.0.0.0/0\n    - id: valkey\n      template:\n        apiVersion: elasticache.services.k8s.aws/v1alpha1\n        kind: CacheCluster\n        metadata:\n          name: ${schema.spec.name}-valkey\n        spec:\n          cacheClusterID: vote-valkey-cluster\n          cacheNodeType: cache.t3.micro\n          cacheSubnetGroupName: ${schema.spec.name}-valkey-subnet-group\n          engine: valkey\n          engineVersion: "8.x"\n          numCacheNodes: 1\n          port: 6379\n          securityGroupIDs:\n            - ${sg.status.id}\n'})})]})}function p(e={}){const{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(u,{...e})}):u(e)}},28453:(e,n,a)=>{a.d(n,{R:()=>r,x:()=>o});var s=a(96540);const t={},c=s.createContext(t);function r(e){const n=s.useContext(c);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),s.createElement(c.Provider,{value:n},e.children)}}}]);