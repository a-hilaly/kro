"use strict";(self.webpackChunkkro_docs=self.webpackChunkkro_docs||[]).push([[7317],{41163:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>h,frontMatter:()=>o,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"docs/concepts/rgd/overview","title":"Overview","description":"A ResourceGraphDefinition (RGD) lets you create a custom Kubernetes API that deploys multiple resources together as a single unit. It\'s the only API you need to configure kro - you define the schema for your new API, the resources it should create, and how data flows between them using CEL expressions.","source":"@site/docs/docs/concepts/rgd/00-overview.md","sourceDirName":"docs/concepts/rgd","slug":"/docs/concepts/rgd/overview","permalink":"/kro/next/docs/concepts/rgd/overview","draft":false,"unlisted":false,"editUrl":"https://github.com/kubernetes-sigs/kro/tree/main/website/docs/docs/concepts/rgd/00-overview.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"sidebar_label":"Overview"},"sidebar":"docsSidebar","previous":{"title":"Quick Start","permalink":"/kro/next/docs/getting-started/deploy-a-resource-graph-definition"},"next":{"title":"Schema Definition","permalink":"/kro/next/docs/concepts/rgd/schema"}}');var i=s(74848),t=s(28453);const o={sidebar_position:1,sidebar_label:"Overview"},c="Overview",a={},d=[{value:"How it Works",id:"how-it-works",level:2},{value:"Example",id:"example",level:2},{value:"Anatomy of a ResourceGraphDefinition",id:"anatomy-of-a-resourcegraphdefinition",level:2},{value:"How kro Processes RGDs",id:"how-kro-processes-rgds",level:2},{value:"Static Analysis and Validation",id:"static-analysis-and-validation",level:3},{value:"Automatic Dependency Management",id:"automatic-dependency-management",level:3},{value:"Generated CRDs and Controllers",id:"generated-crds-and-controllers",level:3},{value:"RGD Status Conditions",id:"rgd-status-conditions",level:3},{value:"What RGDs Provide",id:"what-rgds-provide",level:2},{value:"Next Steps",id:"next-steps",level:2}];function l(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"overview",children:"Overview"})}),"\n",(0,i.jsxs)(n.p,{children:["A ",(0,i.jsx)(n.strong,{children:"ResourceGraphDefinition"})," (RGD) lets you create a custom Kubernetes API that deploys multiple resources together as a single unit. It's the only API you need to configure kro - you define the schema for your new API, the resources it should create, and how data flows between them using CEL expressions."]}),"\n",(0,i.jsx)(n.p,{children:"When you apply an RGD, kro configures itself to serve your new API. It generates a CRD, registers it with the Kubernetes API server, and starts watching for instances. When users create instances of your API, kro creates the underlying resources in the correct order, wires values between them, and manages their full lifecycle."}),"\n",(0,i.jsx)(n.h2,{id:"how-it-works",children:"How it Works"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"You create an RGD"})," defining a new API (like ",(0,i.jsx)(n.code,{children:"Application"}),")"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"kro generates a CRD"})," for your API"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Users create instances"})," of your API"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"kro creates and manages"})," all the underlying resources"]}),"\n"]}),"\n",(0,i.jsx)("div",{style:{textAlign:"center",marginTop:"2rem",marginBottom:"2rem"},children:(0,i.jsx)("img",{src:"/img/overview-diag.svg",alt:"kro RGD Flow",style:{maxWidth:"600px",width:"100%"}})}),"\n",(0,i.jsx)(n.h2,{id:"example",children:"Example"}),"\n",(0,i.jsxs)(n.p,{children:["Here's an RGD that creates a new ",(0,i.jsx)(n.code,{children:"Application"})," API. When users create an ",(0,i.jsx)(n.code,{children:"Application"}),", kro automatically creates a Deployment:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'apiVersion: kro.run/v1alpha1\nkind: ResourceGraphDefinition\nmetadata:\n  name: application\nspec:\n  schema:\n    apiVersion: v1alpha1\n    kind: Application\n    spec:\n      name: string\n      image: string | default="nginx:latest"\n      replicas: integer | default=3\n\n  resources:\n    - id: deployment\n      template:\n        apiVersion: apps/v1\n        kind: Deployment\n        metadata:\n          name: ${schema.spec.name}\n        spec:\n          replicas: ${schema.spec.replicas}\n          selector:\n            matchLabels:\n              app: ${schema.spec.name}\n          template:\n            metadata:\n              labels:\n                app: ${schema.spec.name}\n            spec:\n              containers:\n                - name: app\n                  image: ${schema.spec.image}\n'})}),"\n",(0,i.jsx)(n.p,{children:"Users can now create applications:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"apiVersion: v1alpha1\nkind: Application\nmetadata:\n  name: my-app\nspec:\n  name: my-app\n  image: nginx:1.27\n  replicas: 5\n"})}),"\n",(0,i.jsx)(n.p,{children:"kro will create and manage the Deployment automatically."}),"\n",(0,i.jsx)(n.h2,{id:"anatomy-of-a-resourcegraphdefinition",children:"Anatomy of a ResourceGraphDefinition"}),"\n",(0,i.jsx)(n.p,{children:"An RGD has the standard Kubernetes resource structure:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'apiVersion: kro.run/v1alpha1\nkind: ResourceGraphDefinition\nmetadata: {}      # Standard Kubernetes metadata\nspec:\n  schema: {}      # Define your custom API\n  resources: []   # Define Kubernetes resources to create\nstatus:           # Managed by kro\n  conditions: []\n  state: ""\n  topologicalOrder: []\n'})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:"metadata"})})," - Standard Kubernetes metadata (name, labels, annotations)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:"spec.schema"})})," - Your custom API: what fields users can configure and what computed values to expose"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:"spec.resources"})})," - The Kubernetes resources to create and manage (Deployments, Services, etc.)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:"status"})})," - Current state managed by kro: conditions, overall state, and computed creation order"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["For complete field documentation, see the ",(0,i.jsx)(n.a,{href:"/kro/next/api/crds/resourcegraphdefinition",children:"RGD API Reference"}),"."]}),"\n",(0,i.jsx)(n.h2,{id:"how-kro-processes-rgds",children:"How kro Processes RGDs"}),"\n",(0,i.jsxs)(n.p,{children:["kro performs extensive static analysis to catch errors ",(0,i.jsx)(n.strong,{children:"before deployment"}),". Rather than discovering issues when users create instances, kro validates everything upfront when you create the RGD. Type errors, non-existent fields, missing CRDs, syntax issues, and circular dependencies are all caught during RGD creation, giving you immediate feedback."]}),"\n",(0,i.jsx)("div",{style:{textAlign:"center",margin:"3rem 0"},children:(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"RGD Validation Flow",src:s(10389).A+"",width:"1207",height:"477"})})}),"\n",(0,i.jsx)(n.h3,{id:"static-analysis-and-validation",children:"Static Analysis and Validation"}),"\n",(0,i.jsxs)(n.p,{children:["kro validates your RGD ",(0,i.jsx)(n.strong,{children:"before any instances are created"}),". When you create a ResourceGraphDefinition:"]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Schema validation"})," - Ensures your schema follows the ",(0,i.jsx)(n.a,{href:"/kro/next/api/specifications/simple-schema",children:"SimpleSchema"})," format"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"CRD verification"})," - Validates that all referenced resource types (Deployments, Services, etc.) exist in your cluster"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"CEL type checking"})," - Parses and validates all ",(0,i.jsx)(n.a,{href:"/kro/next/docs/concepts/rgd/cel-expressions",children:"CEL expressions"}),", checking that:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Referenced fields exist in the actual resource schemas"}),"\n",(0,i.jsx)(n.li,{children:"Expression output types match their target field types"}),"\n",(0,i.jsx)(n.li,{children:"All expressions are syntactically correct"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Dependency inference"})," - Automatically analyzes CEL expressions to ",(0,i.jsx)(n.a,{href:"/kro/next/docs/concepts/rgd/dependencies-ordering",children:"infer resource dependencies"})," and compute the creation order"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["This validation happens at RGD creation time, catching errors early before any user creates an instance. For a deep dive into how this works, see ",(0,i.jsx)(n.a,{href:"/kro/next/docs/concepts/rgd/static-type-checking",children:"Static Analysis"}),"."]}),"\n",(0,i.jsx)(n.h3,{id:"automatic-dependency-management",children:"Automatic Dependency Management"}),"\n",(0,i.jsxs)(n.p,{children:["kro analyzes your CEL expressions to automatically infer dependencies between resources. For example, if a Service references ",(0,i.jsx)(n.code,{children:"${deployment.metadata.name}"}),", kro knows the Deployment must be created first. This dependency graph is used to:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Compute creation order"})," - Resources are created in topological order"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Compute deletion order"})," - Resources are deleted in reverse topological order"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Detect circular dependencies"})," - kro rejects RGDs with circular dependencies"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Show the order"})," - The computed order appears in ",(0,i.jsx)(n.code,{children:"status.topologicalOrder"})]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["See ",(0,i.jsx)(n.a,{href:"/kro/next/docs/concepts/rgd/dependencies-ordering",children:"Dependencies & Ordering"})," for details on how this works."]}),"\n",(0,i.jsx)(n.h3,{id:"generated-crds-and-controllers",children:"Generated CRDs and Controllers"}),"\n",(0,i.jsx)(n.p,{children:"When your RGD is validated and accepted:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"CRD generation"})," - kro generates a CustomResourceDefinition for your API and registers it with the Kubernetes API server"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Dynamic controller"})," - kro configures itself to watch for instances of your new API"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Lifecycle management"})," - The controller creates resources in dependency order, evaluates CEL expressions, manages status updates, and handles deletion"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"rgd-status-conditions",children:"RGD Status Conditions"}),"\n",(0,i.jsxs)(n.p,{children:["kro reports the RGD's state through three conditions in ",(0,i.jsx)(n.code,{children:"status.conditions"}),":"]}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Condition"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"ResourceGraphAccepted"})}),(0,i.jsxs)(n.td,{children:["Whether the RGD spec passed validation. If ",(0,i.jsx)(n.code,{children:"False"}),", the ",(0,i.jsx)(n.code,{children:"message"})," field contains the validation error."]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"KindReady"})}),(0,i.jsx)(n.td,{children:"Whether the CRD for your custom API has been generated and registered with Kubernetes."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"ControllerReady"})}),(0,i.jsx)(n.td,{children:"Whether kro is actively watching for instances of your custom API."})]})]})]}),"\n",(0,i.jsxs)(n.p,{children:["When all three conditions are ",(0,i.jsx)(n.code,{children:"True"}),", the RGD is fully operational and ready to accept instances. You can check the status with:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"kubectl get rgd <name> -o yaml\n"})}),"\n",(0,i.jsxs)(n.p,{children:["For complete status field documentation, see the ",(0,i.jsx)(n.a,{href:"/kro/next/api/crds/resourcegraphdefinition",children:"RGD API Reference"}),"."]}),"\n",(0,i.jsx)(n.h2,{id:"what-rgds-provide",children:"What RGDs Provide"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Type safety"}),": All CEL expressions are validated when you create the RGD"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Dependency management"}),": kro automatically determines the order to create resources"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Validation"}),": Users get immediate feedback if they provide invalid values"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Reusability"}),": Define once, use many times across teams"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,i.jsx)(n.p,{children:"Explore the details of ResourceGraphDefinitions:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.a,{href:"/kro/next/docs/concepts/rgd/schema",children:"Schema"})})," - Define your custom API structure"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.a,{href:"/kro/next/docs/concepts/rgd/resource-definitions/resource-basics",children:"Resource Basics"})})," - Define resources with CEL expressions"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.a,{href:"/kro/next/docs/concepts/rgd/resource-definitions/conditional-creation",children:"Conditional Creation"})})," - Create resources conditionally with ",(0,i.jsx)(n.code,{children:"includeWhen"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.a,{href:"/kro/next/docs/concepts/rgd/resource-definitions/readiness",children:"Readiness"})})," - Control when resources are considered ready"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.a,{href:"/kro/next/docs/concepts/rgd/resource-definitions/external-references",children:"External References"})})," - Reference resources outside your RGD"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.a,{href:"/kro/next/docs/concepts/rgd/cel-expressions",children:"CEL Expressions"})})," - Reference data between resources"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.a,{href:"/kro/next/docs/concepts/rgd/dependencies-ordering",children:"Dependencies & Ordering"})})," - How kro infers dependencies and determines creation order"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.a,{href:"/kro/next/docs/concepts/rgd/static-type-checking",children:"Static Type Checking"})})," - How kro validates RGDs before instances are created"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},10389:(e,n,s)=>{s.d(n,{A:()=>r});const r=s.p+"assets/images/rgd-validation-6fdfb26cbdb329476a22b018177c3fc9.svg"},28453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>c});var r=s(96540);const i={},t=r.createContext(i);function o(e){const n=r.useContext(t);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),r.createElement(t.Provider,{value:n},e.children)}}}]);