"use strict";(self.webpackChunkkro_docs=self.webpackChunkkro_docs||[]).push([[6837],{27121:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>p,frontMatter:()=>a,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"docs/concepts/simple-schema","title":"Simple Schema","description":"kro follows a different approach for defining your API schema and shapes. It","source":"@site/versioned_docs/version-0.3.0/docs/concepts/10-simple-schema.md","sourceDirName":"docs/concepts","slug":"/docs/concepts/simple-schema","permalink":"/kro/0.3.0/docs/concepts/simple-schema","draft":false,"unlisted":false,"editUrl":"https://github.com/kubernetes-sigs/kro/tree/main/website/versioned_docs/version-0.3.0/docs/concepts/10-simple-schema.md","tags":[],"version":"0.3.0","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"docsSidebar","previous":{"title":"ResourceGraphDefinitions","permalink":"/kro/0.3.0/docs/concepts/resource-group-definitions"},"next":{"title":"Instances","permalink":"/kro/0.3.0/docs/concepts/instances"}}');var r=s(74848),t=s(28453);const a={sidebar_position:2},l="Simple Schema",d={},c=[{value:"Type Definitions",id:"type-definitions",level:2},{value:"Basic Types",id:"basic-types",level:3},{value:"Structure Types",id:"structure-types",level:3},{value:"Array Types",id:"array-types",level:3},{value:"Map Types",id:"map-types",level:3},{value:"Custom Types",id:"custom-types",level:3},{value:"Validation and Documentation",id:"validation-and-documentation",level:2},{value:"Supported Markers",id:"supported-markers",level:3},{value:"Status Fields",id:"status-fields",level:2},{value:"Default Status Fields",id:"default-status-fields",level:2},{value:"1. Conditions",id:"1-conditions",level:3},{value:"2. State",id:"2-state",level:3}];function o(e){const n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"simple-schema",children:"Simple Schema"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"kro"})," follows a different approach for defining your API schema and shapes. It\nleverages a human-friendly and readable syntax that is OpenAPI specification\ncompatible. Here's a comprehensive example:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'apiVersion: kro.run/v1alpha1\nkind: ResourceGraphDefinition\nmetadata:\n  name: web-application\nspec:\n  schema:\n    apiVersion: v1alpha1\n    kind: WebApplication\n    spec:\n      # Basic types\n      name: string | required=true description="My Name"\n      replicas: integer | default=1 minimum=1 maximum=100\n      image: string | required=true\n\n      # Structured type\n      ingress:\n        enabled: boolean | default=false\n        host: string | default="example.com"\n        path: string | default="/"\n\n      # Array type\n      ports: "[]integer"\n\n      # Map type\n      env: "map[string]mytype"\n\n    # Custom Types\n    types:\n      myType:\n        value1: string | required=true\n        value2: integer | default=42\n\n    status:\n      # Status fields with auto-inferred types\n      availableReplicas: ${deployment.status.availableReplicas}\n      serviceEndpoint: ${service.status.loadBalancer.ingress[0].hostname}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"type-definitions",children:"Type Definitions"}),"\n",(0,r.jsx)(n.h3,{id:"basic-types",children:"Basic Types"}),"\n",(0,r.jsx)(n.p,{children:"kro supports these foundational types:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"string"}),": Text values"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"integer"}),": Whole numbers"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"boolean"}),": True/False values"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"float"}),": Decimal numbers"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"For example:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"name: string\nage: integer\nenabled: boolean\nprice: float\n"})}),"\n",(0,r.jsx)(n.h3,{id:"structure-types",children:"Structure Types"}),"\n",(0,r.jsx)(n.p,{children:"You can create complex objects by nesting fields. Each field can use any type,\nincluding other structures:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'# Simple structure\naddress:\n  street: string\n  city: string\n  zipcode: string\n\n# Nested structures\nuser:\n  name: string\n  address: # Nested object\n    street: string\n    city: string\n  contacts: "[]string" # Array of strings\n'})}),"\n",(0,r.jsx)(n.h3,{id:"array-types",children:"Array Types"}),"\n",(0,r.jsxs)(n.p,{children:["Arrays are denoted using ",(0,r.jsx)(n.code,{children:"[]"})," syntax:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Basic arrays: ",(0,r.jsx)(n.code,{children:"[]string"}),", ",(0,r.jsx)(n.code,{children:"[]integer"}),", ",(0,r.jsx)(n.code,{children:"[]boolean"})]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Examples:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"tags: []string\nports: []integer\n"})}),"\n",(0,r.jsx)(n.h3,{id:"map-types",children:"Map Types"}),"\n",(0,r.jsxs)(n.p,{children:["Maps are key-value pairs denoted as ",(0,r.jsx)(n.code,{children:"map[keyType]valueType"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"map[string]string"}),": String to string mapping"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"map[string]integer"}),": String to integer mapping"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Examples:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'labels: "map[string]string"\nmetrics: "map[string]float"\n'})}),"\n",(0,r.jsx)(n.h3,{id:"custom-types",children:"Custom Types"}),"\n",(0,r.jsxs)(n.p,{children:["Custom types are specified in the separate ",(0,r.jsx)(n.code,{children:"types"})," section.\nThey provide a map of names to type specifications, that follow the simple schema."]}),"\n",(0,r.jsx)(n.p,{children:"Example:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"schema:\n  types:\n    Person:\n      name: string\n      age: integer\n  spec:\n    people: '[]Person | required=true`\n"})}),"\n",(0,r.jsx)(n.h2,{id:"validation-and-documentation",children:"Validation and Documentation"}),"\n",(0,r.jsx)(n.p,{children:"Fields can have multiple markers for validation and documentation:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'name: string | required=true default="app" description="Application name"\nreplicas: integer | default=3 minimum=1 maximum=10\nmode: string | enum="debug,info,warn,error" default="info"\n'})}),"\n",(0,r.jsx)(n.h3,{id:"supported-markers",children:"Supported Markers"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"required=true"}),": Field must be provided"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"default=value"}),": Default value if not specified"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:'description="..."'}),": Field documentation"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:'enum="value1,value2"'}),": Allowed values"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"minimum=value"}),": Minimum value for numbers"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"maximum=value"}),": Maximum value for numbers"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["Multiple markers can be combined using the ",(0,r.jsx)(n.code,{children:"|"})," separator."]}),"\n",(0,r.jsx)(n.p,{children:"For example:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'name: string | required=true default="app" description="Application name"\nreplicas: integer | default=3 minimum=1 maximum=10\nprice: float | minimum=0.01 maximum=999.99\nmode: string | enum="debug,info,warn,error" default="info"\n'})}),"\n",(0,r.jsx)(n.h2,{id:"status-fields",children:"Status Fields"}),"\n",(0,r.jsx)(n.p,{children:"Status fields use CEL expressions to reference values from resources. kro\nautomatically:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Infers the correct types from the expressions"}),"\n",(0,r.jsx)(n.li,{children:"Validates that referenced resources exist"}),"\n",(0,r.jsx)(n.li,{children:"Updates values when the underlying resources change"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"status:\n  # Types are inferred from the referenced fields\n  availableReplicas: ${deployment.status.availableReplicas}\n  endpoint: ${service.status.loadBalancer.ingress[0].hostname}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"default-status-fields",children:"Default Status Fields"}),"\n",(0,r.jsx)(n.p,{children:"kro automatically injects two fields to every instance's status:"}),"\n",(0,r.jsx)(n.h3,{id:"1-conditions",children:"1. Conditions"}),"\n",(0,r.jsx)(n.p,{children:"An array of condition objects tracking the instance's state:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'status:\n  conditions:\n    - type: string # e.g., "Ready", "Progressing"\n      status: string # "True", "False", "Unknown"\n      lastTransitionTime: string\n      reason: string\n      message: string\n'})}),"\n",(0,r.jsx)(n.p,{children:"Common condition types:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Ready"}),": Instance is fully reconciled"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Progressing"}),": Working towards desired state"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Degraded"}),": Operational but not optimal"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Error"}),": Reconciliation error occurred"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"2-state",children:"2. State"}),"\n",(0,r.jsx)(n.p,{children:"A high-level summary of the instance's status:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"status:\n  state: string # Ready, Progressing, Degraded, Unknown, Deleting\n"})}),"\n",(0,r.jsx)(n.admonition,{type:"tip",children:(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"conditions"})," and ",(0,r.jsx)(n.code,{children:"state"})," are reserved words. If defined in your schema, kro will\noverride them with its own values."]})})]})}function p(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>l});var i=s(96540);const r={},t=i.createContext(r);function a(e){const n=i.useContext(t);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);