<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-0.6.2 docs-doc-page docs-doc-id-docs/concepts/resource-group-definitions" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.1">
<title data-rh="true">ResourceGraphDefinitions | kro</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://kro.run/kro/img/kro.svg"><meta data-rh="true" name="twitter:image" content="https://kro.run/kro/img/kro.svg"><meta data-rh="true" property="og:url" content="https://kro.run/kro/0.6.2/docs/concepts/resource-group-definitions"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="0.6.2"><meta data-rh="true" name="docusaurus_tag" content="docs-default-0.6.2"><meta data-rh="true" name="docsearch:version" content="0.6.2"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-0.6.2"><meta data-rh="true" property="og:title" content="ResourceGraphDefinitions | kro"><meta data-rh="true" name="description" content="ResourceGraphDefinitions are the fundamental building blocks in kro. They provide a"><meta data-rh="true" property="og:description" content="ResourceGraphDefinitions are the fundamental building blocks in kro. They provide a"><link data-rh="true" rel="icon" href="/kro/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://kro.run/kro/0.6.2/docs/concepts/resource-group-definitions"><link data-rh="true" rel="alternate" href="https://kro.run/kro/0.6.2/docs/concepts/resource-group-definitions" hreflang="en"><link data-rh="true" rel="alternate" href="https://kro.run/kro/0.6.2/docs/concepts/resource-group-definitions" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"ResourceGraphDefinitions","item":"https://kro.run/kro/0.6.2/docs/concepts/resource-group-definitions"}]}</script><meta name="go-import" content="kro.run/pkg git https://github.com/kubernetes-sigs/kro">
<meta name="go-source" content="kro.run/pkg git https://github.com/kubernetes-sigs/kro https://github.com/kubernetes-sigs/kro/tree/main{/dir} https://github.com/kubernetes-sigs/kro/blob/main{/dir}/{file}#L{line}"><link rel="stylesheet" href="/kro/assets/css/styles.5d887e16.css">
<script src="/kro/assets/js/runtime~main.03fa75e0.js" defer="defer"></script>
<script src="/kro/assets/js/main.6fdc757a.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/kro/"><b class="navbar__title text--truncate">kro</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/kro/0.6.2/docs/overview">Documentation</a><a class="navbar__item navbar__link" href="/kro/0.6.2/api/">Reference</a><a class="navbar__item navbar__link" href="/kro/0.6.2/examples/">Examples</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/kro/0.6.2/docs/concepts/resource-group-definitions">0.6.2</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/kro/next/docs/overview">main</a></li><li><a class="dropdown__link" href="/kro/docs/overview">0.7.1</a></li><li><a class="dropdown__link" href="/kro/0.7.0/docs/overview">0.7.0</a></li><li><a class="dropdown__link" href="/kro/0.6.3/docs/concepts/resource-group-definitions">0.6.3</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/kro/0.6.2/docs/concepts/resource-group-definitions">0.6.2</a></li><li><a class="dropdown__link" href="/kro/0.6.1/docs/concepts/resource-group-definitions">0.6.1</a></li><li><a class="dropdown__link" href="/kro/0.6.0/docs/concepts/resource-group-definitions">0.6.0</a></li><li><a class="dropdown__link" href="/kro/0.5.1/docs/concepts/resource-group-definitions">0.5.1</a></li><li><a class="dropdown__link" href="/kro/0.5.0/docs/concepts/resource-group-definitions">0.5.0</a></li><li><a class="dropdown__link" href="/kro/0.4.1/docs/concepts/resource-group-definitions">0.4.1</a></li><li><a class="dropdown__link" href="/kro/0.4.0/docs/concepts/resource-group-definitions">0.4.0</a></li><li><a class="dropdown__link" href="/kro/0.3.0/docs/concepts/resource-group-definitions">0.3.0</a></li><li><a class="dropdown__link" href="/kro/0.2.2/docs/concepts/resource-group-definitions">0.2.2</a></li><li><a class="dropdown__link" href="/kro/0.2.1/docs/concepts/resource-group-definitions">0.2.1</a></li><li><a class="dropdown__link" href="/kro/0.2.0/docs/concepts/resource-group-definitions">0.2.0</a></li><li><a class="dropdown__link" href="/kro/0.1.0/docs/overview">0.1.0</a></li><li class=""><hr class="dropdown-separator"></li><li><a class="dropdown__link" href="/kro/versions">All versions</a></li></ul></div><a href="https://github.com/kubernetes-sigs/kro" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input id="search_input_react" type="search" placeholder="Loading..." aria-label="Search" class="navbar__search-input search-bar" disabled=""></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/kro/"><b>kro</b></a><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/kro/0.6.2/docs/overview"><span title="What is kro?" class="linkLabel_WmDU">What is kro?</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/kro/0.6.2/docs/getting-started/Installation"><span title="Getting started" class="categoryLinkLabel_W154">Getting started</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/kro/0.6.2/docs/getting-started/Installation"><span title="Installing kro" class="linkLabel_WmDU">Installing kro</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/kro/0.6.2/docs/getting-started/deploy-a-resource-graph-definition"><span title="Deploy Your First ResourceGraphDefinition" class="linkLabel_WmDU">Deploy Your First ResourceGraphDefinition</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/kro/0.6.2/docs/concepts/resource-group-definitions"><span title="Concepts" class="categoryLinkLabel_W154">Concepts</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/kro/0.6.2/docs/concepts/resource-group-definitions"><span title="ResourceGraphDefinitions" class="linkLabel_WmDU">ResourceGraphDefinitions</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/kro/0.6.2/docs/concepts/simple-schema"><span title="Simple Schema" class="linkLabel_WmDU">Simple Schema</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/kro/0.6.2/docs/concepts/instances"><span title="Instances" class="linkLabel_WmDU">Instances</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/kro/0.6.2/docs/concepts/access-control"><span title="Access Control" class="linkLabel_WmDU">Access Control</span></a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/kro/0.6.2/docs/faq"><span title="FAQ" class="linkLabel_WmDU">FAQ</span></a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is documentation for <!-- -->kro<!-- --> <b>0.6.2</b>, which is no longer actively maintained.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/kro/docs/overview">latest version</a></b> (<!-- -->0.7.1<!-- -->).</div></div><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/kro/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Concepts</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">ResourceGraphDefinitions</span></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: 0.6.2</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>ResourceGraphDefinitions</h1></header>
<p>ResourceGraphDefinitions are the fundamental building blocks in <strong>kro</strong>. They provide a
way to define, organize, and manage sets of related Kubernetes resources as a
single, reusable unit.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="what-is-a-resourcegraphdefinition">What is a ResourceGraphDefinition?<a href="#what-is-a-resourcegraphdefinition" class="hash-link" aria-label="Direct link to What is a ResourceGraphDefinition?" title="Direct link to What is a ResourceGraphDefinition?" translate="no">​</a></h2>
<p>A <strong>ResourceGraphDefinition</strong> is a custom resource that lets you create new Kubernetes
APIs for deploying multiple resources together. It acts as a blueprint,
defining:</p>
<ul>
<li>What users can configure (schema)</li>
<li>What resources to create (resources)</li>
<li>How resources reference each other (dependencies)</li>
<li>When resources should be included (conditions)</li>
<li>What status to expose (status)</li>
</ul>
<p>When you create a <strong>ResourceGraphDefinition</strong>, kro generates a new API (a.k.a Custom
Resource Definition) in your cluster that others can use to deploy resources in a
consistent, controlled way.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="anatomy-of-a-resourcegraphdefinition">Anatomy of a ResourceGraphDefinition<a href="#anatomy-of-a-resourcegraphdefinition" class="hash-link" aria-label="Direct link to Anatomy of a ResourceGraphDefinition" title="Direct link to Anatomy of a ResourceGraphDefinition" translate="no">​</a></h2>
<p>A ResourceGraphDefinition, like any Kubernetes resource, consists of three main parts:</p>
<ol>
<li><strong>Metadata</strong>: name, labels, etc.</li>
<li><strong>Spec</strong>: Defines the structure and properties of the ResourceGraphDefinition</li>
<li><strong>Status</strong>: Reflects the current state of the ResourceGraphDefinition</li>
</ol>
<p>The <code>spec</code> section of a ResourceGraphDefinition contains two main components:</p>
<ul>
<li><strong>Schema</strong>: Defines what an instance of your API looks like:<!-- -->
<ul>
<li>What users can configure during creation and update</li>
<li>What status information they can view</li>
<li>Default values and validation rules</li>
</ul>
</li>
<li><strong>Resources</strong>: Specifies the Kubernetes resources to create:<!-- -->
<ul>
<li>Resource templates</li>
<li>Dependencies between resources</li>
<li>Conditions for inclusion</li>
<li>Readiness criteria</li>
<li><a href="#using-externalref-to-reference-objects-outside-the-resourcegraphdefinition">External References</a></li>
</ul>
</li>
</ul>
<p>This structure translates to YAML as follows:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#1f2937;--prism-background-color:#fafafa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#1f2937;background-color:#fafafa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#1f2937"><span class="token key atrule" style="color:#6b7280">apiVersion</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"> kro.run/v1alpha1</span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain"></span><span class="token key atrule" style="color:#6b7280">kind</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"> ResourceGraphDefinition</span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain"></span><span class="token key atrule" style="color:#6b7280">metadata</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">  </span><span class="token key atrule" style="color:#6b7280">name</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"> my</span><span class="token punctuation" style="color:#9ca3af">-</span><span class="token plain">resourcegraphdefinition </span><span class="token comment" style="color:#9ca3af"># Metadata section</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain"></span><span class="token key atrule" style="color:#6b7280">spec</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">  </span><span class="token key atrule" style="color:#6b7280">schema</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"> </span><span class="token comment" style="color:#9ca3af"># Define your API</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">    </span><span class="token key atrule" style="color:#6b7280">apiVersion</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"> v1alpha1 </span><span class="token comment" style="color:#9ca3af"># API version</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">    </span><span class="token key atrule" style="color:#6b7280">kind</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"> MyAPI </span><span class="token comment" style="color:#9ca3af"># API kind</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">    </span><span class="token key atrule" style="color:#6b7280">spec</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#9ca3af">{</span><span class="token punctuation" style="color:#9ca3af">}</span><span class="token plain"> </span><span class="token comment" style="color:#9ca3af"># fields users can configure</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">    </span><span class="token key atrule" style="color:#6b7280">status</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#9ca3af">{</span><span class="token punctuation" style="color:#9ca3af">}</span><span class="token plain"> </span><span class="token comment" style="color:#9ca3af"># fields kro will populate</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">  </span><span class="token comment" style="color:#9ca3af"># Define the resources kro will manage</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">  </span><span class="token key atrule" style="color:#6b7280">resources</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">    </span><span class="token punctuation" style="color:#9ca3af">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#6b7280">id</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"> resource1</span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">      </span><span class="token comment" style="color:#9ca3af"># declare your resources along with default values and variables</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">      </span><span class="token key atrule" style="color:#6b7280">template</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#9ca3af">{</span><span class="token punctuation" style="color:#9ca3af">}</span><br></span></code></pre></div></div>
<p>Let&#x27;s look at each component in detail...</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="understanding-the-schema">Understanding the Schema<a href="#understanding-the-schema" class="hash-link" aria-label="Direct link to Understanding the Schema" title="Direct link to Understanding the Schema" translate="no">​</a></h2>
<p>The schema section defines your new API&#x27;s structure. It determines:</p>
<ul>
<li>What fields users can configure when creating instances</li>
<li>What status information they can view</li>
<li>Type validation and default values</li>
</ul>
<p>Here&#x27;s an example schema:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#1f2937;--prism-background-color:#fafafa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#1f2937;background-color:#fafafa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#1f2937"><span class="token key atrule" style="color:#6b7280">schema</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">  </span><span class="token key atrule" style="color:#6b7280">apiVersion</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"> v1alpha1</span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">  </span><span class="token key atrule" style="color:#6b7280">kind</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"> WebApplication </span><span class="token comment" style="color:#9ca3af"># This becomes your new API type</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">  </span><span class="token key atrule" style="color:#6b7280">spec</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">    </span><span class="token comment" style="color:#9ca3af"># Fields users can configure using a simple, straightforward syntax</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">    </span><span class="token key atrule" style="color:#6b7280">name</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"> string</span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">    </span><span class="token key atrule" style="color:#6b7280">image</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"> string </span><span class="token punctuation" style="color:#9ca3af">|</span><span class="token plain"> default=&quot;nginx&quot;</span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">    </span><span class="token key atrule" style="color:#6b7280">replicas</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"> integer </span><span class="token punctuation" style="color:#9ca3af">|</span><span class="token plain"> default=3</span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">    </span><span class="token key atrule" style="color:#6b7280">ingress</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">      </span><span class="token key atrule" style="color:#6b7280">enabled</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"> boolean </span><span class="token punctuation" style="color:#9ca3af">|</span><span class="token plain"> default=false</span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">  </span><span class="token key atrule" style="color:#6b7280">status</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">    </span><span class="token comment" style="color:#9ca3af"># Fields kro will populate automatically from your resources</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">    </span><span class="token comment" style="color:#9ca3af"># Types are inferred from these CEL expressions</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">    </span><span class="token key atrule" style="color:#6b7280">availableReplicas</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:#9ca3af">{</span><span class="token plain">deployment.status.availableReplicas</span><span class="token punctuation" style="color:#9ca3af">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">    </span><span class="token key atrule" style="color:#6b7280">conditions</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:#9ca3af">{</span><span class="token plain">deployment.status.conditions</span><span class="token punctuation" style="color:#9ca3af">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">  </span><span class="token key atrule" style="color:#6b7280">validation</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">    </span><span class="token comment" style="color:#9ca3af"># Validating admission policies added to the new API type&#x27;s CRD</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">    </span><span class="token punctuation" style="color:#9ca3af">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#6b7280">expression</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"> </span><span class="token string" style="color:#1f2937">&quot;${ self.image == &#x27;nginx&#x27; || !self.ingress.enabled }&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">      </span><span class="token key atrule" style="color:#6b7280">message</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"> </span><span class="token string" style="color:#1f2937">&quot;Only nginx based applications can have ingress enabled&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">  </span><span class="token key atrule" style="color:#6b7280">additionalPrinterColumns</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">    </span><span class="token comment" style="color:#9ca3af"># Printer columns shown for the created custom resource</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">    </span><span class="token punctuation" style="color:#9ca3af">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#6b7280">jsonPath</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"> .status.availableReplicas</span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">      </span><span class="token key atrule" style="color:#6b7280">name</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"> Available replicas</span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">      </span><span class="token key atrule" style="color:#6b7280">type</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"> integer</span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">    </span><span class="token punctuation" style="color:#9ca3af">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#6b7280">jsonPath</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"> .spec.image</span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">      </span><span class="token key atrule" style="color:#6b7280">name</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"> Image</span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">      </span><span class="token key atrule" style="color:#6b7280">type</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"> string</span><br></span></code></pre></div></div>
<p><strong>kro</strong> follows a different approach for defining your API schema and shapes. It
leverages a human-friendly and readable syntax that is OpenAPI spec compatible.
No need to write complex OpenAPI schemas - just define your fields and types in
a straightforward way. For the complete specification of this format, check out
the <a href="/kro/0.6.2/docs/concepts/simple-schema">Simple Schema specification</a>. Status fields use CEL
expressions to reference fields from resources defined in your ResourceGraphDefinition.
kro automatically:</p>
<ul>
<li>Infers the correct types from your expressions</li>
<li>Validates that referenced resources exist</li>
<li>Updates these fields as your resources change</li>
</ul>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="processing">Processing<a href="#processing" class="hash-link" aria-label="Direct link to Processing" title="Direct link to Processing" translate="no">​</a></h2>
<p>When you create a <strong>ResourceGraphDefinition</strong>, kro processes it in several steps to ensure
correctness and set up the necessary components:</p>
<ol>
<li>
<p><strong>Validation</strong>: kro validates your <strong>ResourceGraphDefinition</strong> to ensure it&#x27;s well
formed and follows the correct syntax, maximizing the chances of successful
deployment, and catching as many errors as possible early on. It:</p>
<ul>
<li>Validates your schema definition follows the simple schema format</li>
<li>Ensures all resource templates are valid Kubernetes manifests</li>
<li>Checks that referenced values exist and are of the correct type</li>
<li>Confirms resource dependencies form a valid Directed Acyclic Graph(DAG)
without cycles</li>
<li>Validates all CEL expressions in status fields and conditions using CEL&#x27;s native type system<!-- -->
<ul>
<li>Validates field references exist in the actual resource schemas</li>
<li>Ensures expressions return types compatible with their target fields</li>
<li>Validates that CEL functions called in expressions exist and are used correctly</li>
<li>Checks expression correctness and type compatibility statically without executing expressions</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>API Generation</strong>: kro generates and registers a new CRD in your cluster
based on your schema. For example, if your <strong>ResourceGraphDefinition</strong> defines a
<code>WebApplication</code> API, kro creates a CRD that:</p>
<ul>
<li>Provides API validation based on your schema definition</li>
<li>Automatically applies default values you&#x27;ve defined</li>
<li>Makes status information available to users and other systems</li>
<li>Integrates seamlessly with kubectl and other Kubernetes tools</li>
</ul>
</li>
<li>
<p><strong>Controller Configuration</strong>: kro configures itself to watch for instances of
your new API and their managed resources:</p>
<ul>
<li>Creates all required resources following the dependency order</li>
<li>Manages references and value passing between resources</li>
<li>Handles the complete lifecycle for create, update, and delete operations</li>
<li>Keeps status information up to date based on actual resource states</li>
<li>Automatically detects and reconciles drift in managed resources</li>
<li>Triggers reconciliation when any managed resource changes</li>
</ul>
</li>
</ol>
<p>For instance, when you create a <code>WebApplication</code> ResourceGraphDefinition, kro generates
the <code>webapplications.kro.run</code> CRD. When users create instances of this API, kro
manages all the underlying resources (Deployments, Services, Custom Resources,
etc.) automatically.</p>
<p>kro continuously monitors your ResourceGraphDefinition for changes, updating the API and
its behavior accordingly.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="instance-example">Instance Example<a href="#instance-example" class="hash-link" aria-label="Direct link to Instance Example" title="Direct link to Instance Example" translate="no">​</a></h2>
<p>After the <strong>ResourceGraphDefinition</strong> is validated and registered in the cluster, users
can create instances of it. Here&#x27;s an example of how an instance for the
<code>WebApplication</code> might look:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#1f2937;--prism-background-color:#fafafa"><div class="codeBlockTitle_OeMC">my-web-app-instance.yaml</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#1f2937;background-color:#fafafa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#1f2937"><span class="token key atrule" style="color:#6b7280">apiVersion</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"> kro.run/v1alpha1</span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain"></span><span class="token key atrule" style="color:#6b7280">kind</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"> WebApplication</span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain"></span><span class="token key atrule" style="color:#6b7280">metadata</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">  </span><span class="token key atrule" style="color:#6b7280">name</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"> my</span><span class="token punctuation" style="color:#9ca3af">-</span><span class="token plain">web</span><span class="token punctuation" style="color:#9ca3af">-</span><span class="token plain">app</span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain"></span><span class="token key atrule" style="color:#6b7280">spec</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">  </span><span class="token key atrule" style="color:#6b7280">appName</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"> awesome</span><span class="token punctuation" style="color:#9ca3af">-</span><span class="token plain">app</span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">  </span><span class="token key atrule" style="color:#6b7280">image</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"> nginx</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain">latest</span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">  </span><span class="token key atrule" style="color:#6b7280">replicas</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"> </span><span class="token number" style="color:#1f2937">3</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="more-about-resources">More about Resources<a href="#more-about-resources" class="hash-link" aria-label="Direct link to More about Resources" title="Direct link to More about Resources" translate="no">​</a></h2>
<p>Users can specify more controls in resources in <code>.spec.resources[]</code></p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#1f2937;--prism-background-color:#fafafa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#1f2937;background-color:#fafafa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#1f2937"><span class="token key atrule" style="color:#6b7280">spec</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">  </span><span class="token key atrule" style="color:#6b7280">resources</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">    </span><span class="token punctuation" style="color:#9ca3af">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#6b7280">id</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"> my</span><span class="token punctuation" style="color:#9ca3af">-</span><span class="token plain">resource</span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">      </span><span class="token key atrule" style="color:#6b7280">template || externalRef</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#9ca3af">{</span><span class="token punctuation" style="color:#9ca3af">}</span><span class="token plain"> </span><span class="token comment" style="color:#9ca3af"># users can either template resources or reference objects outside the graph</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">      </span><span class="token key atrule" style="color:#6b7280">readyWhen</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">      </span><span class="token comment" style="color:#9ca3af"># users can specify CEL expressions to determine when a resource is ready</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">      </span><span class="token punctuation" style="color:#9ca3af">-</span><span class="token plain"> $</span><span class="token punctuation" style="color:#9ca3af">{</span><span class="token plain">deployment.status.conditions.exists(x</span><span class="token punctuation" style="color:#9ca3af">,</span><span class="token plain"> x.type == &#x27;Available&#x27; </span><span class="token important" style="color:#1f2937">&amp;&amp;</span><span class="token plain"> x.status == &quot;True&quot;)</span><span class="token punctuation" style="color:#9ca3af">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">      </span><span class="token key atrule" style="color:#6b7280">includeWhen</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">      </span><span class="token comment" style="color:#9ca3af"># users can specify CEL expressions to determine when a resource should be included in the graph</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">      </span><span class="token punctuation" style="color:#9ca3af">-</span><span class="token plain"> $</span><span class="token punctuation" style="color:#9ca3af">{</span><span class="token plain">schema.spec.value.enabled</span><span class="token punctuation" style="color:#9ca3af">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="using-externalref-to-reference-objects-outside-the-resourcegraphdefinition">Using <code>externalRef</code> to reference Objects outside the ResourceGraphDefinition.<a href="#using-externalref-to-reference-objects-outside-the-resourcegraphdefinition" class="hash-link" aria-label="Direct link to using-externalref-to-reference-objects-outside-the-resourcegraphdefinition" title="Direct link to using-externalref-to-reference-objects-outside-the-resourcegraphdefinition" translate="no">​</a></h3>
<p>Users can specify if the object is something that is created out-of-band and needs to be referenced in the RGD.
An external reference could be specified like this:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#1f2937;--prism-background-color:#fafafa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#1f2937;background-color:#fafafa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#1f2937"><span class="token plain">resources:</span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">   id: projectConfig</span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">   externalRef:</span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">     apiVersion: corp.platform.com/v1</span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">     kind: Project</span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">     metadata:</span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">       name: default-project</span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">       namespace: # optional, if empty uses instance namespace</span><br></span></code></pre></div></div>
<p>As part of processing the Resource Graph, the instance reconciler waits for the <code>externalRef</code> object to be present and reads the object from the cluster as a node in the graph. Subsequent resources can use data from this node.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="using-conditional-cel-expressions-">Using Conditional CEL Expressions (<code>?</code>)<a href="#using-conditional-cel-expressions-" class="hash-link" aria-label="Direct link to using-conditional-cel-expressions-" title="Direct link to using-conditional-cel-expressions-" translate="no">​</a></h3>
<p>KRO can make use of CEL Expressions (see <a href="https://github.com/google/cel-spec/wiki/proposal-246" target="_blank" rel="noopener noreferrer">this proposal for details</a> or look at the <a href="https://pkg.go.dev/github.com/google/cel-go/cel#hdr-Syntax_Changes-OptionalTypes" target="_blank" rel="noopener noreferrer">CEL Implementation Reference</a>) to define optional runtime conditions for resources based on the conditional operator <code>?</code>.</p>
<p>This allows you to optionally define values that have no predefined schema or are not hard dependencies in the Graph.</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="using--for-referencing-schema-less-objects-like-configmap-or-secret">Using <code>?</code> for referencing schema-less objects like <code>ConfigMap</code> or <code>Secret</code><a href="#using--for-referencing-schema-less-objects-like-configmap-or-secret" class="hash-link" aria-label="Direct link to using--for-referencing-schema-less-objects-like-configmap-or-secret" title="Direct link to using--for-referencing-schema-less-objects-like-configmap-or-secret" translate="no">​</a></h4>
<p>You can use the <code>optional</code> operator to reference objects that do not have a predefined schema in the ResourceGraphDefinition. This is useful for referencing objects that may or may not exist at runtime.</p>
<blockquote>
<p>⚠️<!-- --> <code>?</code> removes the ability of KRO to introspect the schema of the referenced object. Thus, it cannot wait for fields after the <code>?</code> to be present. It is recommended to use conditional expressions only for objects that are not critical to the ResourceGraphDefinition&#x27;s operation or when the schema cannot be known at design time.</p>
</blockquote>
<p>A config map can be referenced like this:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#1f2937;--prism-background-color:#fafafa"><div class="codeBlockTitle_OeMC">config-map.yaml</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#1f2937;background-color:#fafafa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#1f2937"><span class="token key atrule" style="color:#6b7280">apiVersion</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain"></span><span class="token key atrule" style="color:#6b7280">kind</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"> ConfigMap</span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain"></span><span class="token key atrule" style="color:#6b7280">metadata</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">  </span><span class="token key atrule" style="color:#6b7280">name</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"> demo</span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain"></span><span class="token key atrule" style="color:#6b7280">data</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">  </span><span class="token key atrule" style="color:#6b7280">VALUE</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"> </span><span class="token string" style="color:#1f2937">&quot;foobar&quot;</span><br></span></code></pre></div></div>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#1f2937;--prism-background-color:#fafafa"><div class="codeBlockTitle_OeMC">external reference in ResourceGraphDefinition</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#1f2937;background-color:#fafafa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#1f2937"><span class="token punctuation" style="color:#9ca3af">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#6b7280">id</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"> external</span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">  </span><span class="token key atrule" style="color:#6b7280">externalRef</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">    </span><span class="token key atrule" style="color:#6b7280">apiVersion</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">    </span><span class="token key atrule" style="color:#6b7280">kind</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"> ConfigMap</span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">    </span><span class="token key atrule" style="color:#6b7280">metadata</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">      </span><span class="token key atrule" style="color:#6b7280">name</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"> demo</span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">      </span><span class="token key atrule" style="color:#6b7280">namespace</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"> default</span><br></span></code></pre></div></div>
<p>With this reference, you can access the data in your schema:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#1f2937;--prism-background-color:#fafafa"><div class="codeBlockTitle_OeMC">CEL Expression</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#1f2937;background-color:#fafafa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#1f2937"><span class="token plain">${external.data.?VALUE}</span><br></span></code></pre></div></div>
<blockquote>
<p>⚠️<!-- --> KRO will only wait for the external reference to be present in the cluster, but it will not validate the schema of the referenced config. If the config map does not have the <code>VALUE</code> field, the expression will evaluate to <code>null</code> and might result in unexpected behavior in your application if not handled properly.</p>
</blockquote>
<p><em>For a more detailed example, see the <a href="/kro/0.6.2/examples/basic/optionals">Optional Values &amp; External References</a> documentation.</em></p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="status-reporting">Status Reporting<a href="#status-reporting" class="hash-link" aria-label="Direct link to Status Reporting" title="Direct link to Status Reporting" translate="no">​</a></h2>
<p>The <code>status</code> section of a <code>ResourceGraphDefinition</code> provides information about the state of the graph and it&#x27;s generated <code>CustomResourceDefinition</code> and controller.</p>
<p><code>status</code> includes a stable <code>Ready</code> condition (as well as a set of technical <code>status.conditions</code> that provide more detailed information about the state of the graph and its resources).</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>When the <code>Ready</code> condition <code>status</code> is <code>True</code>, it indicates that the ResourceGraphDefinition is valid and you can use it to create <a href="/kro/0.6.2/docs/concepts/instances">instances</a>.</p></div></div>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p>Try to only rely on the <code>Ready</code> condition, as other condition types may change frequently and are more technical in nature, can change their API over time and are generally more indicative of KRO&#x27;s internal state.</p></div></div>
<p>Additionally, the ResourceGraphDefinition contains a <code>topologicalOrder</code> field that provides a list of resources in the order they should be processed. This is useful for understanding the dependencies between resources and their apply order.</p>
<p>Generally a status in <code>ResourceGraphDefinition</code> may look like</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#1f2937;--prism-background-color:#fafafa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#1f2937;background-color:#fafafa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#1f2937"><span class="token key atrule" style="color:#6b7280">status</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">  </span><span class="token key atrule" style="color:#6b7280">conditions</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">    </span><span class="token punctuation" style="color:#9ca3af">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#6b7280">lastTransitionTime</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"> </span><span class="token string" style="color:#1f2937">&quot;2025-08-06T17:26:41Z&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">      </span><span class="token key atrule" style="color:#6b7280">message</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"> resource graph and schema are valid</span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">      </span><span class="token key atrule" style="color:#6b7280">observedGeneration</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"> </span><span class="token number" style="color:#1f2937">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">      </span><span class="token key atrule" style="color:#6b7280">reason</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"> Valid</span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">      </span><span class="token key atrule" style="color:#6b7280">status</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"> </span><span class="token string" style="color:#1f2937">&quot;True&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">      </span><span class="token key atrule" style="color:#6b7280">type</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"> ResourceGraphAccepted</span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">    </span><span class="token punctuation" style="color:#9ca3af">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#6b7280">lastTransitionTime</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"> </span><span class="token string" style="color:#1f2937">&quot;2025-08-06T17:26:41Z&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">      </span><span class="token key atrule" style="color:#6b7280">message</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"> kind DeploymentService has been accepted and ready</span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">      </span><span class="token key atrule" style="color:#6b7280">observedGeneration</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"> </span><span class="token number" style="color:#1f2937">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">      </span><span class="token key atrule" style="color:#6b7280">reason</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"> Ready</span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">      </span><span class="token key atrule" style="color:#6b7280">status</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"> </span><span class="token string" style="color:#1f2937">&quot;True&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">      </span><span class="token key atrule" style="color:#6b7280">type</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"> KindReady</span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">    </span><span class="token punctuation" style="color:#9ca3af">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#6b7280">lastTransitionTime</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"> </span><span class="token string" style="color:#1f2937">&quot;2025-08-06T17:26:41Z&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">      </span><span class="token key atrule" style="color:#6b7280">message</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"> controller is running</span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">      </span><span class="token key atrule" style="color:#6b7280">observedGeneration</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"> </span><span class="token number" style="color:#1f2937">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">      </span><span class="token key atrule" style="color:#6b7280">reason</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"> Running</span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">      </span><span class="token key atrule" style="color:#6b7280">status</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"> </span><span class="token string" style="color:#1f2937">&quot;True&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">      </span><span class="token key atrule" style="color:#6b7280">type</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"> ControllerReady</span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">    </span><span class="token punctuation" style="color:#9ca3af">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#6b7280">lastTransitionTime</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"> </span><span class="token string" style="color:#1f2937">&quot;2025-08-06T17:26:41Z&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">      </span><span class="token key atrule" style="color:#6b7280">message</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"> </span><span class="token string" style="color:#1f2937">&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">      </span><span class="token key atrule" style="color:#6b7280">observedGeneration</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"> </span><span class="token number" style="color:#1f2937">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">      </span><span class="token key atrule" style="color:#6b7280">reason</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"> Ready</span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">      </span><span class="token key atrule" style="color:#6b7280">status</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"> </span><span class="token string" style="color:#1f2937">&quot;True&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">      </span><span class="token key atrule" style="color:#6b7280">type</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"> Ready</span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">  </span><span class="token key atrule" style="color:#6b7280">state</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"> Active</span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">  </span><span class="token key atrule" style="color:#6b7280">topologicalOrder</span><span class="token punctuation" style="color:#9ca3af">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">    </span><span class="token punctuation" style="color:#9ca3af">-</span><span class="token plain"> configmap</span><br></span><span class="token-line" style="color:#1f2937"><span class="token plain">    </span><span class="token punctuation" style="color:#9ca3af">-</span><span class="token plain"> deployment</span><br></span></code></pre></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/kubernetes-sigs/kro/tree/main/website/versioned_docs/version-0.6.2/docs/concepts/00-resource-group-definitions.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/kro/0.6.2/docs/getting-started/deploy-a-resource-graph-definition"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Deploy Your First ResourceGraphDefinition</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/kro/0.6.2/docs/concepts/simple-schema"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Simple Schema</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#what-is-a-resourcegraphdefinition" class="table-of-contents__link toc-highlight">What is a ResourceGraphDefinition?</a></li><li><a href="#anatomy-of-a-resourcegraphdefinition" class="table-of-contents__link toc-highlight">Anatomy of a ResourceGraphDefinition</a></li><li><a href="#understanding-the-schema" class="table-of-contents__link toc-highlight">Understanding the Schema</a></li><li><a href="#processing" class="table-of-contents__link toc-highlight">Processing</a></li><li><a href="#instance-example" class="table-of-contents__link toc-highlight">Instance Example</a></li><li><a href="#more-about-resources" class="table-of-contents__link toc-highlight">More about Resources</a><ul><li><a href="#using-externalref-to-reference-objects-outside-the-resourcegraphdefinition" class="table-of-contents__link toc-highlight">Using <code>externalRef</code> to reference Objects outside the ResourceGraphDefinition.</a></li><li><a href="#using-conditional-cel-expressions-" class="table-of-contents__link toc-highlight">Using Conditional CEL Expressions (<code>?</code>)</a></li></ul></li><li><a href="#status-reporting" class="table-of-contents__link toc-highlight">Status Reporting</a></li></ul></div></div></div></div></main></div></div></div><section class="kroFooter_cB_W"><p class="kroFooterText_sBXB">Brought to you with ♥ by<!-- --> <a href="https://github.com/kubernetes/community/tree/master/sig-cloud-provider" target="_blank" rel="noopener noreferrer">SIG Cloud Provider</a></p></section><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/kro/docs/overview">Tutorial</a></li><li class="footer__item"><a class="footer__link-item" href="/kro/examples/">Examples</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://kubernetes.slack.com/archives/C081TMY9D6Y" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/kubernetes-sigs/kro/blob/main/CONTRIBUTING.md" target="_blank" rel="noopener noreferrer" class="footer__link-item">Contribution Guide<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/kubernetes-sigs/kro" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://www.youtube.com/channel/UCUlcI3NYq9ehl5wsdfbJzSA" target="_blank" rel="noopener noreferrer" class="footer__link-item">YouTube<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">kro is a subproject of Kubernetes SIG Cloud Provider. Kubernetes is a CNCF graduated project.</div></div></div></footer><script defer="" src="https://static.cloudflareinsights.com/beacon.min.js" data-cf-beacon="{&quot;token&quot;: &quot;85e669833a874cdd938772c6e459b33e&quot;}"></script></div>
</body>
</html>